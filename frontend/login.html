<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" type="image/png" href="assets/imagenes/mathome-favicon.png">
  <title>Mathome - Acceso</title>

  <link rel="stylesheet" href="assets/css/common.css">
  <link rel="stylesheet" href="assets/css/participant.css">

  <style>
    /* ===== LOGIN LAYOUT PREMIUM ===== */
    .auth-shell{
      min-height: 100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 28px 14px;
      position: relative;
      overflow: hidden;
      isolation: isolate;
    }

    /* Fondo limpio: “premium dark” con glow suave */
    .auth-shell::before{
      content:"";
      position: fixed;
      inset: 0;
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(255,215,0,.08), transparent 60%),
        radial-gradient(900px 520px at 85% 25%, rgba(56,189,248,.07), transparent 60%),
        radial-gradient(900px 520px at 55% 95%, rgba(34,197,94,.06), transparent 60%),
        linear-gradient(180deg, rgba(11,11,15,1), rgba(11,11,15,1));
      z-index: -1;
    }

    .auth-wrapper{
      width: min(460px, 96vw);
      text-align:center;
      position: relative;
      z-index: 2;
    }

    /* ===== STORY / CHAT FX ===== */
    .story-stream{
      position: absolute;
      inset: 0;
      z-index: 1;
      pointer-events: none;
      overflow: hidden;
    }

    .story-lane{
      position: absolute;
      top: 0;
      bottom: 0;
      width: min(34vw, 320px);
    }

    .story-lane-left{ left: 0; }
    .story-lane-right{ right: 0; }

    .chat-float{
      position: absolute;
      bottom: -120px;
      left: var(--x, 10%);
      width: min(260px, 75vw);
      display: flex;
      align-items: flex-start;
      gap: 10px;
      opacity: 0;
      animation: bubbleRise var(--dur, 11s) linear forwards;
      animation-delay: var(--delay, 0s);
      filter: drop-shadow(0 8px 24px rgba(0,0,0,.45));
    }

    .chat-avatar{
      width: 34px;
      height: 34px;
      border-radius: 999px;
      display: grid;
      place-items: center;
      font-size: .72rem;
      font-weight: 900;
      color: #fff;
      background: linear-gradient(135deg, rgba(56,189,248,.9), rgba(34,197,94,.9));
      border: 1px solid rgba(255,255,255,.2);
      flex-shrink: 0;
    }

    .chat-bubble{
      background: rgba(10, 16, 30, .78);
      border: 1px solid rgba(255, 215, 0, .22);
      color: rgba(241,245,249,.95);
      border-radius: 14px;
      padding: 10px 12px;
      font-size: .82rem;
      line-height: 1.3;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }

    .chat-user{
      display: block;
      font-size: .7rem;
      text-transform: uppercase;
      letter-spacing: .06em;
      color: rgba(255,215,0,.9);
      margin-bottom: 4px;
    }

    @keyframes bubbleRise{
      0%{
        transform: translateY(0) translateX(0) scale(.94);
        opacity: 0;
      }
      8%{
        opacity: .95;
      }
      65%{
        opacity: .88;
      }
      100%{
        transform: translateY(-115vh) translateX(var(--drift, -12px)) scale(1.02);
        opacity: 0;
      }
    }

    /* ===== BRAND / LOGO ===== */
    .brand{
      display:flex;
      flex-direction: column;
      align-items:center;
      gap: 4px;
      margin-bottom: 8px;
    }

    .brand-logo-frame{
      width: min(520px, 96%);
      max-width: 520px;
      height: clamp(180px, 36vh, 330px);
      overflow: hidden;
      display: grid;
      place-items: start center;
    }

    .brand-logo{
      width: 100%;
      height: auto;
      display:block;
      filter: drop-shadow(0 18px 50px rgba(0,0,0,.55));
      opacity: .98;
    }

    .brand-title{
      margin: 2px 0 0;
      font-weight: 900;
      letter-spacing: .03em;
    }

    .brand-sub{
      margin: -2px 0 0;
      color: var(--colour-muted);
      font-size: .95rem;
    }

    .live-tracker{
      margin: 6px 0 12px;
      padding: 10px 10px 8px;
      text-align: left;
      border-radius: 16px;
      border: 1px solid rgba(255,215,0,.2);
      background: linear-gradient(180deg, rgba(13,18,32,.7), rgba(8,12,22,.74));
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      overflow: hidden;
    }

    .live-tracker__head{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: .72rem;
      letter-spacing: .08em;
      text-transform: uppercase;
      color: rgba(255,215,0,.95);
      margin: 2px 4px 8px;
    }

    .live-tracker__left{
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .live-tracker__dot{
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 5px rgba(34,197,94,.12);
      animation: trackerPulse 1.7s ease-in-out infinite;
    }

    .live-tracker__count{
      color: rgba(241,245,249,.8);
      letter-spacing: .04em;
      text-transform: none;
      font-size: .72rem;
    }

    .chat-thread{
      height: 138px;
      padding: 2px 6px 8px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 6px;
      position: relative;
    }

    .chat-msg{
      max-width: 82%;
      padding: 7px 10px;
      border-radius: 12px;
      font-size: .81rem;
      line-height: 1.3;
      color: rgba(241,245,249,.96);
      opacity: 0;
      transform: translateY(8px) scale(.98);
      animation: chatIn .25s ease forwards;
      word-break: break-word;
    }

    .chat-msg.user{
      align-self: flex-end;
      background: linear-gradient(180deg, rgba(56,189,248,.32), rgba(30,64,175,.34));
      border: 1px solid rgba(125,211,252,.32);
      border-bottom-right-radius: 4px;
    }

    .chat-msg.host{
      align-self: flex-start;
      background: linear-gradient(180deg, rgba(37,99,235,.16), rgba(15,23,42,.75));
      border: 1px solid rgba(255,215,0,.22);
      border-bottom-left-radius: 4px;
    }

    .chat-typing{
      max-width: 84px;
      align-self: flex-start;
      display: none;
      align-items: center;
      gap: 4px;
      padding: 8px 10px;
      border-radius: 12px;
      border-bottom-left-radius: 4px;
      border: 1px solid rgba(255,215,0,.2);
      background: rgba(15,23,42,.8);
    }

    .chat-typing.is-visible{
      display: inline-flex;
    }

    .typing-dot{
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(241,245,249,.9);
      animation: typingDots 1s infinite ease-in-out;
    }

    .typing-dot:nth-child(2){ animation-delay: .18s; }
    .typing-dot:nth-child(3){ animation-delay: .34s; }

    @keyframes trackerPulse{
      0%, 100%{ transform: scale(1); }
      50%{ transform: scale(1.18); }
    }

    @keyframes chatIn{
      to{
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes typingDots{
      0%, 70%, 100%{ opacity: .28; transform: translateY(0); }
      35%{ opacity: 1; transform: translateY(-2px); }
    }

    /* ===== CARD ===== */
    .auth-card{
      position: relative;
      padding: 26px 24px;
      border-radius: 1.2rem;
      margin-top: 12px;
      text-align: left;

      /* 🔥 FONDO MEZCLADO CON LA IMAGEN */
      background:
        linear-gradient(
          180deg,
          rgba(15,15,25,0.88),
          rgba(10,10,16,0.92)
        );

      /* efecto cristal */
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);

      /* borde sutil dorado */
      border: 1px solid rgba(255,215,0,0.18);

      /* sombra profunda (no tarjeta flotante) */
      box-shadow:
        0 25px 60px rgba(0,0,0,.65),
        inset 0 0 0 1px rgba(255,255,255,.03);
    }

    .auth-card::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius: inherit;
      background:
        radial-gradient(
          circle at top,
          rgba(255,215,0,.08),
          transparent 60%
        );
      pointer-events:none;
    }



    .auth-card h3{
      text-align:center;
      margin: 0 0 14px 0;
      letter-spacing: .10em;
      text-transform: uppercase;
      font-size: .95rem;
      color: var(--gold);
    }

    .auth-field{ margin-bottom: 12px; }

    .auth-field label{
      display:block;
      font-size: .83rem;
      margin: 0 0 6px 0;
      color: rgba(245,245,245,.92);
    }

    .auth-field input{
      width: 100%;
      background: rgba(2,6,23,.55);
      border: 1px solid rgba(148,163,184,.22);
      color: var(--colour-text);
      border-radius: 12px;
      padding: 12px 12px;
      outline: none;
      transition: box-shadow .15s ease, border-color .15s ease;
    }

    .auth-field input:focus{
      border-color: rgba(255,215,0,.55);
      box-shadow: 0 0 0 4px rgba(255,215,0,.12);
    }

    /* ===== PRIMARY BUTTON ===== */
    .btn-wide{
      width:100%;
      margin-top: 8px;
      padding: 12px 14px;
      border-radius: 14px;
      letter-spacing: .08em;
      text-transform: uppercase;
      font-weight: 900;
    }

    /* Micro-trust debajo del botón */
    .trust-row{
      margin-top: 12px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      color: rgba(245,245,245,.72);
      font-size: .82rem;
    }

    .trust-dot{
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: rgba(34,197,94,.85);
      box-shadow: 0 0 0 4px rgba(34,197,94,.12);
    }

    /* Switch links */
    .switch-link{
      margin-top: 12px;
      font-size: .88rem;
      color: rgba(255,215,0,.90);
      cursor:pointer;
      text-align:center;
    }
    .switch-link:hover{ text-decoration: underline; }

    .hidden{ display:none !important; }

    /* ===== TERMINOS ===== */
    .terms-field{
      margin: 12px 0 6px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(148,163,184,.20);
      background: rgba(2,6,23,.35);
    }

    .terms-row{
      display:flex;
      align-items:flex-start;
      gap: 10px;
      font-size: .88rem;
      color: rgba(245,245,245,.86);
    }

    .terms-row input[type="checkbox"]{
      width: 18px;
      height: 18px;
      margin-top: 2px;
      accent-color: var(--gold);
    }

    .terms-link{
      color: var(--gold);
      text-decoration: underline;
      cursor: pointer;
    }

    /* ===== MODAL TERMINOS ===== */
    .terms-modal{
      position: fixed;
      inset: 0;
      z-index: 9999;
      display: grid;
      place-items: center;
      padding: 20px;
    }

    .terms-modal.hidden{
      display: none !important;
    }

    .terms-modal__backdrop{
      position: absolute;
      inset: 0;
      background: rgba(6,6,10,.72);
      backdrop-filter: blur(6px);
    }

    .terms-modal__card{
      position: relative;
      width: min(720px, 94vw);
      max-height: 90vh;
      overflow: hidden;
      border-radius: 18px;
      border: 1px solid rgba(255,215,0,.22);
      background:
        linear-gradient(180deg, rgba(16,16,24,.98), rgba(10,10,16,.98));
      box-shadow: 0 30px 80px rgba(0,0,0,.65);
      display: flex;
      flex-direction: column;
    }

    .terms-modal__header{
      display:flex;
      align-items:center;
      justify-content: space-between;
      padding: 16px 18px;
      border-bottom: 1px solid rgba(148,163,184,.18);
    }

    .terms-modal__header h4{
      margin: 0;
      letter-spacing: .06em;
      text-transform: uppercase;
      font-size: .85rem;
      color: var(--gold);
    }

    .terms-modal__close{
      background: transparent;
      border: 1px solid rgba(148,163,184,.25);
      color: var(--colour-text);
      width: 34px;
      height: 34px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 20px;
      line-height: 1;
    }

    .terms-modal__body{
      padding: 16px 18px 6px;
      overflow: auto;
    }

    .terms-full{
      color: rgba(245,245,245,.82);
      font-size: .9rem;
      line-height: 1.55;
    }

    .terms-modal__actions{
      display:flex;
      gap: 10px;
      justify-content: flex-end;
      padding: 14px 18px 18px;
      border-top: 1px solid rgba(148,163,184,.18);
      background: rgba(9,9,14,.75);
    }

    /* Ajuste mobile */
    @media (max-width: 420px){
      .auth-shell{
        align-items: flex-start;
        padding-top: 14px;
      }
      .auth-card{ padding: 18px 16px; }
      .brand-sub{ font-size: .9rem; }
      .brand-logo-frame{
        width: min(360px, 90%);
        height: clamp(140px, 30vh, 220px);
      }
      .terms-modal__actions{ flex-direction: column; }
      .story-lane{ width: 56vw; }
      .story-lane-right{ display: none; }
    }

    @media (prefers-reduced-motion: reduce){
      .chat-float{
        animation: none !important;
        display: none !important;
      }
    }
  </style>
</head>

<body>
  <div class="auth-shell">
    <div class="story-stream" aria-hidden="true">
      <div class="story-lane story-lane-left" id="storyLaneLeft"></div>
      <div class="story-lane story-lane-right" id="storyLaneRight"></div>
    </div>

    <div class="auth-wrapper">

      <!-- BRAND -->
      <div class="brand">
        <div class="brand-logo-frame">
          <img
            src="assets/imagenes/mathome sin fondo.png"
            alt="Mathome"
            class="brand-logo"
          />
        </div>
        <p class="brand-sub">Todo pasa en vivo.</p>
      </div>

      <div class="live-tracker" aria-live="polite">
        <div class="live-tracker__head">
          <div class="live-tracker__left">
            <span class="live-tracker__dot"></span>
            <span>Seguimiento en sala</span>
          </div>
          <span class="live-tracker__count" id="liveTrackerCount">127 conectados</span>
        </div>
        <div class="chat-thread" id="liveTrackerThread">
          <div class="chat-msg host">Ya casi inicia el giro de la suerte.</div>
          <div class="chat-msg user">Estamos viendo peli y esperando ese giro.</div>
          <div class="chat-typing" id="liveTrackerTyping" aria-hidden="true">
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
          </div>
        </div>
      </div>

      <!-- LOGIN -->
      <section id="loginForm" class="auth-card">
        <h3>Iniciar sesión</h3>

        <div class="auth-field">
          <label for="loginEmail">Correo</label>
          <input type="email" id="loginEmail" placeholder="usuario@correo.com" autocomplete="email">
        </div>

        <div class="auth-field">
          <label for="loginPass">Contraseña</label>
          <input type="password" id="loginPass" placeholder="********" autocomplete="current-password">
        </div>

        <button class="btn btn-primary btn-wide" onclick="login()">Entra al momento</button>

        <div class="trust-row">
          <span class="trust-dot"></span>
          <span>Acceso seguro | Chat en vivo | Pagos verificados</span>
        </div>

        <div class="switch-link" onclick="showRegistro()">
          ¿No tienes cuenta? Registrarse
        </div>
      </section>

      <!-- REGISTRO -->
      <section id="registroForm" class="auth-card hidden" style="margin-top:14px;">
        <h3>Crear cuenta</h3>

        <div class="auth-field">
          <label for="regNombre">Nombre completo</label>
          <input type="text" id="regNombre" placeholder="Nombre y Apellido" autocomplete="name">
          <small id="errorNombre" class="error-msg"></small>
        </div>

        <div class="auth-field">
          <label for="regEmail">Correo</label>
          <input type="email" id="regEmail" placeholder="email@ejemplo.com" autocomplete="email">
          <small id="errorEmail" class="error-msg"></small>
        </div>

        <div class="auth-field">
          <label for="regTelefono">Telefono</label>
          <input type="tel" id="regTelefono" placeholder="+57 3XX XXX XXXX" autocomplete="tel">
          <small id="errorTelefono" class="error-msg"></small>
        </div>

        <div class="auth-field">
          <label for="regAlias">Nombre público (opcional)</label>
          <input type="text" id="regAlias" placeholder="Tu nombre en la sala" autocomplete="nickname">
          <small class="text-muted" style="display:block; margin-top:4px; font-size:12px;">3-20, letras/números/_</small>
          <small id="errorAlias" class="error-msg"></small>
        </div>

        <div class="auth-field">
          <label for="regPass">Contraseña</label>
          <input type="password" id="regPass" placeholder="********" autocomplete="new-password">
          <small id="errorPass" class="error-msg"></small>
        </div>

        <div class="auth-field">
          <label for="regPassConfirm">Confirmar contraseña</label>
          <input type="password" id="regPassConfirm" placeholder="********" autocomplete="new-password">
          <small id="errorPassConfirm" class="error-msg"></small>
        </div>

        <div class="terms-field">
          <label class="terms-row">
            <input type="checkbox" id="regTerms" />
            <span>
              Acepto los
              <span class="terms-link" id="openTermsModal">Términos y Condiciones</span>
            </span>
          </label>
          <small id="errorTerms" class="error-msg"></small>
        </div>

        <button class="btn btn-primary btn-wide" onclick="registro()">
          Registrarme
        </button>

        <div class="switch-link" onclick="showLogin()">
          ¿Ya tienes cuenta? Iniciar sesión
        </div>
      </section>

    </div>
  </div>

  <!-- MODAL TERMINOS -->
  <div id="termsModal" class="terms-modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="termsTitle">
    <div class="terms-modal__backdrop" data-terms-close></div>
    <div class="terms-modal__card" role="document">
      <div class="terms-modal__header">
        <h4 id="termsTitle">Términos y Condiciones</h4>
        <button class="terms-modal__close" type="button" data-terms-close aria-label="Cerrar">X</button>
      </div>
      <div class="terms-modal__body">
        <div class="terms-full">
          <p><strong>TÉRMINOS Y CONDICIONES DE USO – MATHOME</strong></p>
          <p>Última actualización: 2026</p>
          <p>Al registrarte y utilizar la plataforma Mathome, aceptas de forma expresa los presentes Términos y Condiciones. Si no estás de acuerdo con alguno de ellos, no debes utilizar la plataforma.</p>
          <p><strong>1. IDENTIDAD Y VERACIDAD DE LOS DATOS</strong></p>
          <p>El usuario declara que la información proporcionada durante el registro (nombre, correo electrónico, teléfono y demás datos) es real, exacta y actualizada.</p>
          <p>Mathome no se responsabiliza por problemas derivados de información falsa o incorrecta.</p>
          <p><strong>2. TRATAMIENTO DE DATOS PERSONALES</strong></p>
          <p>Al registrarte, autorizas el tratamiento de tus datos personales con fines de:</p>
          <p>Creación y administración de tu cuenta.</p>
          <p>Contacto relacionado con sorteos, premios o notificaciones operativas.</p>
          <p>Verificación de identidad y prevención de fraudes.</p>
          <p>Los datos no serán vendidos a terceros. Podrán compartirse únicamente cuando sea necesario para la operación del servicio o por requerimiento legal.</p>
          <p><strong>3. USO ADECUADO DEL SERVICIO</strong></p>
          <p>El usuario se compromete a:</p>
          <p>No crear múltiples cuentas con la finalidad de obtener ventajas indebidas.</p>
          <p>No utilizar la plataforma para actividades fraudulentas, ilegales o engañosas.</p>
          <p>Respetar las reglas específicas de cada sorteo publicadas en la plataforma.</p>
          <p>El incumplimiento podrá resultar en la suspensión o cancelación definitiva de la cuenta, sin derecho a reclamos.</p>
          <p><strong>4. SORTEOS Y PREMIOS</strong></p>
          <p>Los sorteos se rigen por reglas específicas visibles dentro de la plataforma.</p>
          <p>Los resultados son definitivos una vez publicados y validados conforme a dichas reglas.</p>
          <p>Mathome no garantiza resultados ni premios fuera de las condiciones establecidas en cada sorteo.</p>
          <p><strong>5. COMUNICACIONES</strong></p>
          <p>El usuario acepta recibir comunicaciones electrónicas relacionadas con:</p>
          <p>Actividad de la cuenta.</p>
          <p>Participación en sorteos.</p>
          <p>Notificaciones técnicas o administrativas.</p>
          <p>Estas comunicaciones son parte esencial del servicio.</p>
          <p><strong>6. DISPONIBILIDAD DEL SERVICIO</strong></p>
          <p>Mathome podrá suspender temporalmente el acceso a la plataforma por:</p>
          <p>Mantenimiento técnico.</p>
          <p>Actualizaciones.</p>
          <p>Seguridad del sistema.</p>
          <p>No se garantiza disponibilidad continua e ininterrumpida.</p>
          <p><strong>7. RESPONSABILIDAD</strong></p>
          <p>El uso de la plataforma es bajo responsabilidad del usuario.</p>
          <p>Mathome no será responsable por daños indirectos, pérdidas de oportunidad o fallos externos al sistema.</p>
          <p><strong>8. MODIFICACIONES</strong></p>
          <p>Mathome se reserva el derecho de modificar estos Términos y Condiciones en cualquier momento.</p>
          <p>Los cambios serán efectivos desde su publicación en la plataforma.</p>
          <p><strong>9. ACEPTACIÓN</strong></p>
          <p>Al marcar la casilla "Acepto los Términos y Condiciones", el usuario declara que:</p>
          <p>Ha leído el contenido completo.</p>
          <p>Comprende su alcance.</p>
          <p>Acepta expresamente todos los puntos aquí descritos.</p>
        </div>
      </div>
      <div class="terms-modal__actions">
        <button class="btn btn-secondary" type="button" data-terms-close>Cerrar</button>
        <button class="btn btn-primary" type="button" id="termsAcceptBtn">Aceptar</button>
      </div>
    </div>
  </div>

  <script src="assets/js/app-config.js"></script>
  <script src="assets/js/config.js"></script>
  <script src="assets/js/auth.js"></script>

  <script>
    function showRegistro() {
      document.getElementById("loginForm").classList.add("hidden");
      document.getElementById("registroForm").classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function showLogin() {
      document.getElementById("registroForm").classList.add("hidden");
      document.getElementById("loginForm").classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    (function initStoryBubbles() {
      const leftLane = document.getElementById('storyLaneLeft');
      const rightLane = document.getElementById('storyLaneRight');
      if (!leftLane || !rightLane) return;
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

      const users = [
        'Alex', 'Naty', 'Fer', 'Sofi', 'Leo', 'Majo', 'Dani', 'Pipe', 'Lina', 'Meli'
      ];
      const messages = [
        'Listo el combo para peli, esperando que gire la suerte.',
        'Entrando a sala, hoy sí cae el premio grande.',
        'Ya prendimos la peli, avisen cuando arranque la ruleta.',
        'Equipo completo en chat, que se active el giro.',
        'Mi número está caliente, esta noche toca.',
        'Se siente la energía, a esperar el giro final.',
        'Todo en vivo, snacks listos y ojos en la suerte.',
        'Conectado desde ya, pendiente del próximo giro.',
        'Hoy se ve buena racha, vamos con toda.',
        'Nada de dormirse, que la suerte aparece rápido.'
      ];

      function createBubble(lane) {
        const bubble = document.createElement('div');
        bubble.className = 'chat-float';
        bubble.style.setProperty('--x', `${6 + Math.random() * 58}%`);
        bubble.style.setProperty('--drift', `${-28 + Math.random() * 56}px`);
        bubble.style.setProperty('--dur', `${9 + Math.random() * 6}s`);
        bubble.style.setProperty('--delay', `${Math.random() * 1.8}s`);

        const user = users[Math.floor(Math.random() * users.length)];
        const message = messages[Math.floor(Math.random() * messages.length)];
        const initials = user.slice(0, 2).toUpperCase();

        bubble.innerHTML = `
          <div class="chat-avatar">${initials}</div>
          <div class="chat-bubble">
            <span class="chat-user">${user}</span>
            ${message}
          </div>
        `;

        bubble.addEventListener('animationend', () => bubble.remove());
        lane.appendChild(bubble);
      }

      function pickLane() {
        if (window.innerWidth < 700) return leftLane;
        return Math.random() > 0.5 ? leftLane : rightLane;
      }

      for (let i = 0; i < 6; i += 1) {
        createBubble(pickLane());
      }

      setInterval(() => {
        createBubble(pickLane());
      }, 1300);
    })();

    (function initLiveTracker() {
      const thread = document.getElementById('liveTrackerThread');
      const typing = document.getElementById('liveTrackerTyping');
      const count = document.getElementById('liveTrackerCount');
      if (!thread || !typing || !count) return;

      const queue = [
        { side: 'host', text: 'Entramos en cuenta regresiva para girar.' },
        { side: 'user', text: 'Activo, ya tengo mi numero listo.' },
        { side: 'host', text: 'Mientras esperan, comenten su prediccion.' },
        { side: 'user', text: 'Yo digo que hoy se prende la racha.' },
        { side: 'host', text: 'Se abre sala completa en segundos.' },
        { side: 'user', text: 'Con snacks y peli, no me pierdo este giro.' },
        { side: 'host', text: 'Chat encendido. Alerta de giro inminente.' },
        { side: 'user', text: 'Vamos con todo, que llegue la suerte.' }
      ];

      let i = 0;
      let online = 127;

      function pushMessage(item) {
        const node = document.createElement('div');
        node.className = `chat-msg ${item.side}`;
        node.textContent = item.text;
        thread.insertBefore(node, typing);

        while (thread.querySelectorAll('.chat-msg').length > 5) {
          const first = thread.querySelector('.chat-msg');
          if (first) first.remove();
        }

        thread.scrollTop = thread.scrollHeight;
      }

      function randomCountDelta() {
        return Math.floor(Math.random() * 5) - 1;
      }

      setInterval(() => {
        typing.classList.add('is-visible');
        setTimeout(() => {
          typing.classList.remove('is-visible');
          pushMessage(queue[i]);
          i = (i + 1) % queue.length;
          online = Math.max(95, online + randomCountDelta());
          count.textContent = `${online} conectados`;
        }, 1200);
      }, 2600);
    })();
  </script>

  <!-- Welcome Modal -->
  <script src="assets/js/welcomeModal.js"></script>
</body>
</html>








