<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Siempre Ganas â€” Elige tus nÃºmeros y entra a la ruleta</title>

  <link rel="stylesheet" href="../assets/css/common.css">
  <link rel="stylesheet" href="../assets/css/participant.css">
  <link rel="stylesheet" href="../assets/js/chat/chat.css">


</head>
<body>
  <div class="main-container sorteo-page">

    <!-- HEADER COMPACTO (sticky) -->
    <header class="sorteo-header">
      <div class="sorteo-header__text">
        <h1 id="tituloSorteo" class="sorteo-title">Cargando sorteo...</h1>
        <p id="subtituloSorteo" class="sorteo-subtitle">
          EstÃ¡s a unos pasos de asegurar tus nÃºmeros ğŸŸï¸
        </p>
      </div>

      <div class="sorteo-header__actions">
        <button type="button" class="btn btn-ghost" onclick="location.href='dashboard.html'">
          â† Volver a sorteos
        </button>

        <button id="btnMisNumeros" type="button" class="btn btn-primary hidden" onclick="location.href='mis-numeros.html'">
          ğŸŸ Mis nÃºmeros
        </button>

        <button type="button" class="btn btn-icon" onclick="logout()" aria-label="Salir" title="Salir">
          â‹
        </button>
      </div>
    </header>

    <!-- CARD PRINCIPAL DEL SORTEO -->
    <section class="sorteo-card-premium">
      <p id="tituloPremio" class="sorteo-card__eyebrow">Sorteo</p>

      <div class="sorteo-card__list">
        <p class="sorteo-info-line">âœ… Incluye producto digital + entrada a la ruleta</p>
        <p class="sorteo-info-line">ğŸ Premio principal: <span id="textoPremio">â€”</span></p>
        <p class="sorteo-info-line">ğŸ’² Precio por nÃºmero: <span id="textoPrecio">â€”</span></p>
        <p class="sorteo-info-line">ğŸ”¢ Total de nÃºmeros: <span id="textoCantidad">â€”</span></p>
      </div>

      <div class="progress-wrapper">
        <div class="progress-container">
          <div id="progressFill" class="progress-bar"></div>
        </div>
        <p class="progress-text" id="textoProgreso">Cargando ocupaciÃ³n...</p>
        <p class="progress-tip-text" id="textoCupos">Quedan cupos disponibles</p>
      </div>
    </section>

    <!-- ESTADO DEL USUARIO -->
    <section class="sorteo-status">
      <div id="estadoNoParticipante" class="status-card status-locked">
        <div class="status-title">ğŸ”’ AÃºn no participas</div>
        <div class="status-text">Elige tus nÃºmeros para entrar a la sala.</div>
      </div>

      <div id="misNumerosEnSorteoCard" class="status-card status-ok" style="display:none;">
        <div class="status-title">âœ… Ya estÃ¡s participando en este sorteo</div>
        <div class="status-text" id="misNumerosEnSorteoTexto">Cargando...</div>
        <div id="misNumerosEnSorteoChips" class="numeros-chips-wrap"></div>
      </div>
    </section>

    <!-- FLUJO POR PASOS -->
    <section class="sorteo-flow">

      <!-- PASO 1 -->
      <details class="info-accordion" open>
        <summary>
          <span>ğŸ¯ Paso 1 Â· Elige tus nÃºmeros</span>
          <span class="pago-nequi-badge">1</span>
        </summary>

        <div class="sorteo-numeros-card">
          <div class="sorteo-numeros-header">
            <h3>Elige tus nÃºmeros</h3>
            <p class="text-muted microhint">
              MÃ¡x. <strong><span id="maxNumerosTexto">5</span></strong> por compra
            </p>
          </div>

          <div class="numeros-scroll">
            <div id="gridNumeros" class="numeros-grid"></div>
          </div>

          <div class="mini-resumen-compra">
            <div class="mini-resumen-row">
              <span class="mini-label">SelecciÃ³n</span>
              <strong id="resumenNumeros">Ninguno todavÃ­a</strong>
            </div>
            <div class="mini-resumen-row">
              <span class="mini-label">Total</span>
              <strong id="resumenTotal">$0</strong>
            </div>
          </div>
        </div>
      </details>

      <!-- PASO 2 -->
      <details class="info-accordion">
        <summary>
          <span>ğŸ’³ Paso 2 Â· Paga por Nequi</span>
          <span class="pago-nequi-badge">2</span>
        </summary>

        <div class="pago-nequi-card">
          <div class="pago-nequi-header">
            <div>
              <p class="pago-nequi-title">Paga tus nÃºmeros por Nequi</p>
              <p class="pago-nequi-subtitle">Asegura tu lugar en menos de 1 minuto âš¡</p>
            </div>
          </div>

          <div class="pago-nequi-main">
            <div class="pago-nequi-datos">
              <p class="pago-nequi-label">NÃºmero Nequi</p>
              <p class="pago-nequi-value pago-nequi-value--big">3045538465</p>

              <p class="pago-nequi-label">Titular</p>
              <p class="pago-nequi-value">Jen** Por***</p>

              <button type="button" class="btn btn-primary btn-nequi-copy" onclick="copiarNequi()">
                ğŸ“‹ Copiar nÃºmero de Nequi
              </button>
            </div>

            <div class="pago-nequi-steps">
              <ol>
                <li>Elige tus nÃºmeros y mira el total.</li>
                <li>EnvÃ­a el pago con la nota <strong>"Sorteo + tu nombre"</strong>.</li>
                <li>Sube el comprobante.</li>
              </ol>
              <p class="pago-nequi-seguro">ğŸ›¡ï¸ RevisiÃ³n manual para mantener el sorteo transparente.</p>
            </div>
          </div>

          <div class="pago-nequi-footer">
            ğŸ’¡ Tip: si te gustan ciertos nÃºmeros, pÃ¡galos apenas los elijas.
          </div>
        </div>
      </details>

      <!-- PASO 3 -->
      <details class="info-accordion">
        <summary>
          <span>ğŸ§¾ Paso 3 Â· Subir comprobante</span>
          <span class="pago-nequi-badge">3</span>
        </summary>

        <div class="sorteo-compra-card">
          <div class="comprobante-upload">
            <label for="inputComprobante">Comprobante de pago</label>
            <p class="text-muted microhint">Que se vea <strong>monto</strong> y <strong>referencia</strong>.</p>

            <input type="file" id="inputComprobante" accept="image/*" />

            <div id="previewComprobante" class="comprobante-preview oculto">
              <p class="comprobante-preview-title">Vista previa:</p>
              <img id="imgPreview" alt="Comprobante" />
            </div>
          </div>

          <button id="btnConfirmar" class="btn btn-primary btn-full-width">
            Confirmar participaciÃ³n
          </button>

          <details class="mini-ayuda">
            <summary>Â¿QuÃ© pasa despuÃ©s?</summary>
            <p class="text-muted">
              Tus nÃºmeros quedan <strong>pendientes</strong> hasta revisiÃ³n. Al aprobar, quedan <strong>activos</strong>.
            </p>
          </details>
        </div>
      </details>

    </section>

    <!-- CHAT -->
    <section id="chatContainer" class="chat-card chat-sala" style="display: none;">
      <div class="chat-header">
        <div>
          <h3>ğŸ’¬ Sala del sorteo</h3>
          <p class="text-muted microhint">ğŸ”’ Solo participantes pueden escribir</p>
        </div>
      </div>
      <div id="chatBody" class="chat-messages"></div>
      <div class="chat-input-wrap">
        <input id="chatInput" type="text" placeholder="Escribe aquÃ­..." maxlength="120">
        <button id="chatSend" class="btn btn-primary">Enviar</button>
      </div>
      <p id="chatHint" class="text-muted chat-hint"></p>
    </section>

  </div>

  <div id="toast" class="toast hidden">Mensaje</div>

  <script src="../assets/js/config.js"></script>
  <script src="../assets/js/auth.js"></script>
  <script type="module" src="../assets/js/participante/sorteo-detalle.js"></script>
</body>
</html>
